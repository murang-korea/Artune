<!-- server/public/view.html -->
<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Artune - 보기</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="styles.css">
<style>
  .panel{width:100%;display:block;margin-bottom:10px;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.04)}
  .meta-wrap{display:flex;justify-content:space-between;align-items:center;padding:12px 0}
</style>
</head>
<body>
  <header class="header">
    <div class="brand"><img src="logo.svg" alt="Artune"><div style="font-weight:700">Artune</div></div>
    <div class="actions"><button class="btn" onclick="location.href='/'">목록</button></div>
  </header>

  <main class="container">
    <div id="info" class="card" style="padding:14px"></div>
    <div id="content" style="margin-top:12px"></div>
  </main>

<script>
async function load(){
  const params = new URLSearchParams(location.search);
  const id = params.get('id');
  if(!id){ location.href = '/'; return; }
  const res = await fetch(`/api/posts/${id}`);
  const j = await res.json();
  if(!j.ok){ alert('게시물 없음'); location.href = '/'; return; }
  const p = j.post;
  document.getElementById('info').innerHTML = `
    <div class="meta-wrap">
      <div>
        <h2 style="margin:0">${p.title}</h2>
        <div class="small">by ${p.author} · ${new Date(p.created_at).toLocaleString()}</div>
      </div>
      <div>
        <button class="btn ghost" id="shareBtn">공유</button>
      </div>
    </div>
  `;
  const content = document.getElementById('content');
  content.innerHTML = '';
  p.images.forEach(url=>{
    const img = document.createElement('img');
    img.src = url;
    img.className = 'panel';
    content.appendChild(img);
  });

  document.getElementById('shareBtn').addEventListener('click', ()=>{
    const shareUrl = location.href;
    navigator.clipboard?.writeText(shareUrl).then(()=> alert('링크 복사됨'));
  });
}
load();
</script>
</body>
</html>
